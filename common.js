const MATERIALS = {
    ingot: { 
        name: 'Hardened Alloy', 
        icon: 'https://cdn.discordapp.com/attachments/1409198146579599370/1409198188526698607/Hardened-Alloy.png?ex=68ac8195&is=68ab3015&hm=64faeb260280976a7dcbb4480c9331ccf60ce5998b276c6f6f81b88e73807de8&',
        fallback: '‚öíÔ∏è'
    },
    potion: { 
        name: 'Polishing Solution', 
        icon: 'https://cdn.discordapp.com/attachments/1409198146579599370/1409198345938800741/Polishing-Solution.png?ex=68ac81bb&is=68ab303b&hm=29faf42c48355d8a6ab6b3b33bd8ae2f1afdbe84d533f4aad1887028b168cad9&',
        fallback: 'üß™'
    },
    scroll: { 
        name: 'Design Plans', 
        icon: 'https://cdn.discordapp.com/attachments/1409198146579599370/1409198489732251759/Design-Plan.png?ex=68ac81dd&is=68ab305d&hm=8e87fa8c10e93749dd5df75243b5c6967f83d03389158fb7889c842f7c960cd1&',
        fallback: 'üìú'
    },
    amber: { 
        name: 'Lunar Amber', 
        icon: 'https://cdn.discordapp.com/attachments/1409198146579599370/1409198627854749817/item_icon_600051.png?ex=68ac81fe&is=68ab307e&hm=6eb791380095ca8bd335e1d00d1e5769aaf5eb81aa8a188991cf68f433edda2e&',
        fallback: 'üíé'
    }
};

const CHARM_MATERIALS = {
    guide: {
        name: 'Charm Guide',
        icon: 'https://cdn.discordapp.com/attachments/1409198146579599370/1409618616114221076/charm-guide.png?ex=68ae0923&is=68acb7a3&hm=996b8b991998e7283dfdf7ef55c53c7e576a2f1171902870aa5a9f70c60e35a8&',
        fallback: 'üìñ'
    },
    design: {
        name: 'Charm Design',
        icon: 'https://cdn.discordapp.com/attachments/1409198146579599370/1409618591094935693/charm-design.png?ex=68ae091d&is=68acb79d&hm=0439745de8f0a5e311b8af0bbadca2f2b37a2652b999c70b7dd13f832f468e7a&',
        fallback: 'üé®'
    },
    secret: {
        name: 'Charm Secret',
        icon: 'https://cdn.discordapp.com/attachments/1409198146579599370/1409618637333073950/item_icon_600026.png?ex=68ae0928&is=68acb7a8&hm=646551179463712b2b379840d1ea9fe5ae20efcf32365b57fea317dddf791bfc&',
        fallback: 'üîÆ'
    }
};

const GEAR_PIECES = {
    helmet: { 
        name: 'Helmet', 
        icon: 'https://cdn.discordapp.com/attachments/1247926344519585842/1247926480031055872/Helmet.png?ex=6661d445&is=666082c5&hm=e1a0b36341d9e26e0e71649a5b3a8080f8373809618b76c8c4a45749298586f7&',
        fallback: '‚õëÔ∏è'
    },
    chestplate: { 
        name: 'Chestplate', 
        icon: 'https://cdn.discordapp.com/attachments/1247926344519585842/1247926478201716757/Chest.png?ex=6661d445&is=666082c5&hm=442d8157778b8a735e5d3090740924976451a56f0b09460a3493b8c4d7e10398&',
        fallback: 'üõ°Ô∏è'
    },
    pants: { 
        name: 'Pants', 
        icon: 'https://cdn.discordapp.com/attachments/1247926344519585842/1247926479539425390/Pants.png?ex=6661d445&is=666082c5&hm=d3d63b2f5188f6c321689255018a032f6277f3a9a1d47190e386375003c20c0f&',
        fallback: 'üëñ'
    },
    watch: { 
        name: 'Watch', 
        icon: 'https://cdn.discordapp.com/attachments/1247926344519585842/1247926475713417246/Watch.png?ex=6661d444&is=666082c4&hm=fd4b01e2335272a71b4a39591414e0e4952d765d752f4c207d4b4a6217596b79&',
        fallback: '‚åö'
    },
    ring: { 
        name: 'Ring', 
        icon: 'https://cdn.discordapp.com/attachments/1247926344519585842/1247926477144572015/Ring.png?ex=6661d445&is=666082c5&hm=2173f62e83467406a6442c55e9757f49514f762f0263f13f1e98d1a613663a89&',
        fallback: 'üíç'
    },
    staff: { 
        name: 'Staff', 
        icon: 'https://cdn.discordapp.com/attachments/1247926344519585842/1247926476489379860/Weapon.png?ex=6661d444&is=666082c4&hm=89e954b4f535174e797a26f8b0548d1c99f91a92e19483015f628c61099684b3&',
        fallback: 'ü™Ñ'
    }
};

const CHARM_UPGRADE_COSTS = [
    { guide: 0, design: 0, secret: 0 },
    { guide: 5, design: 5, secret: 0 },
    { guide: 40, design: 15, secret: 0 },
    { guide: 60, design: 40, secret: 0 },
    { guide: 80, design: 100, secret: 0 },
    { guide: 100, design: 200, secret: 0 },
    { guide: 120, design: 300, secret: 0 },
    { guide: 140, design: 400, secret: 0 },
    { guide: 200, design: 400, secret: 0 },
    { guide: 300, design: 400, secret: 0 },
    { guide: 420, design: 420, secret: 0 },
    { guide: 560, design: 420, secret: 0 },
    { guide: 580, design: 450, secret: 15 },
    { guide: 580, design: 450, secret: 30 },
    { guide: 600, design: 500, secret: 45 },
    { guide: 600, design: 500, secret: 70 },
    { guide: 650, design: 550, secret: 100 }
];

const CHARM_STATS = [
    { statBonus: 0, power: 0 },
    { statBonus: 9.00, power: 205700 },
    { statBonus: 12.00, power: 288000 },
    { statBonus: 16.00, power: 370000 },
    { statBonus: 19.00, power: 452000 },
    { statBonus: 25.00, power: 576000 },
    { statBonus: 30.00, power: 700000 },
    { statBonus: 35.00, power: 824000 },
    { statBonus: 40.00, power: 948000 },
    { statBonus: 45.00, power: 1072000 },
    { statBonus: 50.00, power: 1196000 },
    { statBonus: 55.00, power: 1320000 },
    { statBonus: 64.00, power: 1444000 },
    { statBonus: 73.00, power: 1568000 },
    { statBonus: 82.00, power: 1692000 },
    { statBonus: 91.00, power: 1816000 },
    { statBonus: 100.00, power: 1940000 }
];

const GEAR_TIERS = [
    { name: "", ingot: 0, potion: 0, scroll: 0, amber: 0, svsPoints: 0 },
    { name: "Uncommon", ingot: 1500, potion: 15, scroll: 0, amber: 0, svsPoints: 1125 },
    { name: "Uncommon ‚≠ê", ingot: 3800, potion: 40, scroll: 0, amber: 0, svsPoints: 1875 },
    { name: "Rare", ingot: 7000, potion: 70, scroll: 0, amber: 0, svsPoints: 3000 },
    { name: "Rare ‚≠ê", ingot: 0, potion: 0, scroll: 45, amber: 0, svsPoints: 4500 },
    { name: "Rare ‚≠ê‚≠ê", ingot: 0, potion: 0, scroll: 50, amber: 0, svsPoints: 5100 },
    { name: "Epic", ingot: 0, potion: 0, scroll: 60, amber: 0, svsPoints: 3230 },
    { name: "Epic ‚≠ê", ingot: 0, potion: 0, scroll: 70, amber: 0, svsPoints: 3230 },
    { name: "Epic ‚≠ê‚≠ê", ingot: 6500, potion: 65, scroll: 40, amber: 0, svsPoints: 3225 },
    { name: "Epic ‚≠ê‚≠ê‚≠ê", ingot: 8000, potion: 80, scroll: 50, amber: 0, svsPoints: 3225 },
    { name: "Epic T1", ingot: 10000, potion: 95, scroll: 60, amber: 0, svsPoints: 3440 },
    { name: "Epic T1 ‚≠ê", ingot: 11000, potion: 110, scroll: 70, amber: 0, svsPoints: 3440 },
    { name: "Epic T1 ‚≠ê‚≠ê", ingot: 13000, potion: 130, scroll: 85, amber: 0, svsPoints: 4085 },
    { name: "Epic T1 ‚≠ê‚≠ê‚≠ê", ingot: 15000, potion: 160, scroll: 100, amber: 0, svsPoints: 4085 },
    { name: "Mythic", ingot: 22000, potion: 220, scroll: 40, amber: 0, svsPoints: 6250 },
    { name: "Mythic ‚≠ê", ingot: 23000, potion: 230, scroll: 40, amber: 0, svsPoints: 6250 },
    { name: "Mythic ‚≠ê‚≠ê", ingot: 25000, potion: 250, scroll: 45, amber: 0, svsPoints: 6250 },
    { name: "Mythic ‚≠ê‚≠ê‚≠ê", ingot: 26000, potion: 260, scroll: 45, amber: 0, svsPoints: 6250 },
    { name: "Mythic T1", ingot: 28000, potion: 280, scroll: 45, amber: 0, svsPoints: 6250 },
    { name: "Mythic T1 ‚≠ê", ingot: 30000, potion: 300, scroll: 55, amber: 0, svsPoints: 6250 },
    { name: "Mythic T1 ‚≠ê‚≠ê", ingot: 32000, potion: 320, scroll: 55, amber: 0, svsPoints: 6250 },
    { name: "Mythic T1 ‚≠ê‚≠ê‚≠ê", ingot: 35000, potion: 340, scroll: 55, amber: 0, svsPoints: 6250 },
    { name: "Mythic T2", ingot: 38000, potion: 390, scroll: 55, amber: 0, svsPoints: 6250 },
    { name: "Mythic T2 ‚≠ê", ingot: 43000, potion: 430, scroll: 75, amber: 0, svsPoints: 2320 },
    { name: "Mythic T2 ‚≠ê‚≠ê", ingot: 45000, potion: 460, scroll: 80, amber: 0, svsPoints: 2320 },
    { name: "Mythic T2 ‚≠ê‚≠ê‚≠ê", ingot: 48000, potion: 500, scroll: 85, amber: 0, svsPoints: 2320 },
    { name: "Legendary Step 1", ingot: 12500, potion: 132, scroll: 21, amber: 2, svsPoints: 2600 },
    { name: "Legendary Step 2", ingot: 12500, potion: 132, scroll: 21, amber: 2, svsPoints: 2320 },
    { name: "Legendary Step 3", ingot: 12500, potion: 132, scroll: 21, amber: 2, svsPoints: 2320 },
    { name: "Legendary Step 4", ingot: 12500, potion: 134, scroll: 22, amber: 4, svsPoints: 2320 },
    { name: "Legendary ‚≠ê Step 1", ingot: 13000, potion: 140, scroll: 22, amber: 2, svsPoints: 2600 },
    { name: "Legendary ‚≠ê Step 2", ingot: 13000, potion: 140, scroll: 22, amber: 2, svsPoints: 2310 },
    { name: "Legendary ‚≠ê Step 3", ingot: 13000, potion: 140, scroll: 22, amber: 2, svsPoints: 2310 },
    { name: "Legendary ‚≠ê Step 4", ingot: 13000, potion: 140, scroll: 24, amber: 4, svsPoints: 2310 },
    { name: "Legendary ‚≠ê‚≠ê Step 1", ingot: 13500, potion: 140, scroll: 23, amber: 2, svsPoints: 2630 },
    { name: "Legendary ‚≠ê‚≠ê Step 2", ingot: 13500, potion: 140, scroll: 23, amber: 2, svsPoints: 2330 },
    { name: "Legendary ‚≠ê‚≠ê Step 3", ingot: 13500, potion: 140, scroll: 23, amber: 2, svsPoints: 2330 },
    { name: "Legendary ‚≠ê‚≠ê Step 4", ingot: 13500, potion: 149, scroll: 26, amber: 4, svsPoints: 2330 },
    { name: "Legendary ‚≠ê‚≠ê‚≠ê Step 1", ingot: 14000, potion: 155, scroll: 25, amber: 2, svsPoints: 2570 },
    { name: "Legendary ‚≠ê‚≠ê‚≠ê Step 2", ingot: 14000, potion: 155, scroll: 25, amber: 2, svsPoints: 2300 },
    { name: "Legendary ‚≠ê‚≠ê‚≠ê Step 3", ingot: 14000, potion: 155, scroll: 25, amber: 2, svsPoints: 2300 },
    { name: "Legendary ‚≠ê‚≠ê‚≠ê Step 4", ingot: 14000, potion: 155, scroll: 25, amber: 4, svsPoints: 2300 },
    { name: "Legendary T1 Step 1", ingot: 14750, potion: 167, scroll: 27, amber: 3, svsPoints: 2660 },
    { name: "Legendary T1 Step 2", ingot: 14750, potion: 167, scroll: 27, amber: 3, svsPoints: 2300 },
    { name: "Legendary T1 Step 3", ingot: 14750, potion: 167, scroll: 27, amber: 3, svsPoints: 2300 },
    { name: "Legendary T1 Step 4", ingot: 14750, potion: 169, scroll: 29, amber: 6, svsPoints: 2300 },
    { name: "Legendary T1 ‚≠ê Step 1", ingot: 15250, potion: 182, scroll: 28, amber: 3, svsPoints: 2660 },
    { name: "Legendary T1 ‚≠ê Step 2", ingot: 15250, potion: 182, scroll: 28, amber: 3, svsPoints: 2320 },
    { name: "Legendary T1 ‚≠ê Step 3", ingot: 15750, potion: 182, scroll: 28, amber: 3, svsPoints: 2320 },
    { name: "Legendary T1 ‚≠ê Step 4", ingot: 15750, potion: 184, scroll: 31, amber: 6, svsPoints: 2320 },
    { name: "Legendary T1 ‚≠ê‚≠ê Step 1", ingot: 15750, potion: 182, scroll: 30, amber: 3, svsPoints: 2600 },
    { name: "Legendary T1 ‚≠ê‚≠ê Step 2", ingot: 15750, potion: 182, scroll: 30, amber: 3, svsPoints: 2320 },
    { name: "Legendary T1 ‚≠ê‚≠ê Step 3", ingot: 15750, potion: 182, scroll: 30, amber: 3, svsPoints: 2320 },
    { name: "Legendary T1 ‚≠ê‚≠ê Step 4", ingot: 15750, potion: 184, scroll: 30, amber: 6, svsPoints: 2320 },
    { name: "Legendary T1 ‚≠ê‚≠ê‚≠ê Step 1", ingot: 16250, potion: 190, scroll: 31, amber: 3, svsPoints: 2600 },
    { name: "Legendary T1 ‚≠ê‚≠ê‚≠ê Step 2", ingot: 16250, potion: 190, scroll: 31, amber: 3, svsPoints: 2370 },
    { name: "Legendary T1 ‚≠ê‚≠ê‚≠ê Step 3", ingot: 16250, potion: 190, scroll: 31, amber: 3, svsPoints: 2370 },
    { name: "Legendary T1 ‚≠ê‚≠ê‚≠ê Step 4", ingot: 16250, potion: 190, scroll: 32, amber: 6, svsPoints: 2370 },
    { name: "Legendary T2 Step 1", ingot: 17000, potion: 202, scroll: 33, amber: 5, svsPoints: 2450 },
    { name: "Legendary T2 Step 2", ingot: 17000, potion: 202, scroll: 33, amber: 5, svsPoints: 2390 },
    { name: "Legendary T2 Step 3", ingot: 17000, potion: 202, scroll: 33, amber: 5, svsPoints: 2390 },
    { name: "Legendary T2 Step 4", ingot: 17000, potion: 204, scroll: 36, amber: 5, svsPoints: 2390 },
    { name: "Legendary T2 ‚≠ê Step 1", ingot: 17500, potion: 210, scroll: 35, amber: 5, svsPoints: 2390 },
    { name: "Legendary T2 ‚≠ê Step 2", ingot: 17500, potion: 210, scroll: 35, amber: 5, svsPoints: 2380 },
    { name: "Legendary T2 ‚≠ê Step 3", ingot: 17500, potion: 210, scroll: 35, amber: 5, svsPoints: 2380 },
    { name: "Legendary T2 ‚≠ê Step 4", ingot: 17500, potion: 210, scroll: 35, amber: 5, svsPoints: 2380 },
    { name: "Legendary T2 ‚≠ê‚≠ê Step 1", ingot: 18000, potion: 217, scroll: 36, amber: 5, svsPoints: 2420 },
    { name: "Legendary T2 ‚≠ê‚≠ê Step 2", ingot: 18000, potion: 217, scroll: 36, amber: 5, svsPoints: 2380 },
    { name: "Legendary T2 ‚≠ê‚≠ê Step 3", ingot: 18000, potion: 217, scroll: 36, amber: 5, svsPoints: 2380 },
    { name: "Legendary T2 ‚≠ê‚≠ê Step 4", ingot: 18000, potion: 219, scroll: 37, amber: 5, svsPoints: 2380 },
    { name: "Legendary T2 ‚≠ê‚≠ê‚≠ê Step 1", ingot: 18500, potion: 225, scroll: 37, amber: 5, svsPoints: 2420 },
    { name: "Legendary T2 ‚≠ê‚≠ê‚≠ê Step 2", ingot: 18500, potion: 225, scroll: 37, amber: 5, svsPoints: 2370 },
    { name: "Legendary T2 ‚≠ê‚≠ê‚≠ê Step 3", ingot: 0, potion: 0, scroll: 37, amber: 0, svsPoints: 2370 }
];

const LANGUAGES = {
    en: { flag: 'üá∫üá∏', name: 'English' },
    zh: { flag: 'üá®üá≥', name: '‰∏≠Êñá' },
    ja: { flag: 'üáØüáµ', name: 'Êó•Êú¨Ë™û' },
    ko: { flag: 'üá∞üá∑', name: 'ÌïúÍµ≠Ïñ¥' },
    es: { flag: 'üá™üá∏', name: 'Espa√±ol' },
    fr: { flag: 'üá´üá∑', name: 'Fran√ßais' },
    de: { flag: 'üá©üá™', name: 'Deutsch' },
    ru: { flag: 'üá∑üá∫', name: '–†—É—Å—Å–∫–∏–π' },
    pt: { flag: 'üáßüá∑', name: 'Portugu√™s' },
    it: { flag: 'üáÆüáπ', name: 'Italiano' },
    ar: { flag: 'üá∏üá¶', name: 'ÿßŸÑÿπÿ±ÿ®Ÿäÿ©' },
    hi: { flag: 'üáÆüá≥', name: '‡§π‡§ø‡§®‡•ç‡§¶‡•Ä' }
};

const TRANSLATIONS = {
    en: {
        title: "Whiteout Survival Calculator",
        logoMain: "Whiteout Survival",
        logoSub: "Calculator Suite",
        home: "Home",
        heroTitle: "Game Enhancement Tools",
        heroSubtitle: "Optimize your gameplay with precision calculations",
        chiefGear: "Chief Gear",
        chiefCharms: "Chief Charms",
        available: "Available",
        comingSoon: "Coming Soon",
        supportTitle: "Support Development",
        supportDescription: "If you want to contribute and support my development project. You can gift me using my ID underneath.",
        gameId: "Game ID",
        pageTitle: "Chief Gear Calculator",
        pageSubtitle: "Calculate materials needed to upgrade your chief gear",
        currentInventory: "Current Inventory",
        quickSetAll: "Quick Set All",
        currentLevel: "Current Level",
        desiredLevel: "Desired Level",
        selectLevel: "Select level...",
        helmet: "Helmet",
        chestplate: "Chestplate",
        pants: "Pants",
        watch: "Watch",
        ring: "Ring",
        staff: "Staff",
        calculateMaterialsNeeded: "Calculate Materials Needed",
        upgradeAnalysis: "Upgrade Analysis",
        materialsNeededFor: "Materials needed for",
        selectedPieces: "selected piece(s)",
        sufficient: "‚úì Sufficient",
        needMore: "Need",
        more: "more",
        youHaveEnough: "You have enough!",
        additionalMaterialsNeeded: "Additional materials needed",
        totalRequired: "Total Required",
        current: "Current",
        surplus: "Surplus",
        missing: "Missing",
        desiredLevelRequired: ": Desired level is required",
        invalidDesiredLevel: ": Invalid desired level",
        desiredLevelMustBeHigher: ": Desired level must be higher than current level",
        selectAtLeastOnePiece: "Please select at least one gear piece to calculate upgrade costs.",
        svsPointsGained: "SvS Points Gained",
        totalSvsPoints: "Total SvS Points",
        charmsPageTitle: "Chief Charms Calculator",
        charmsPageSubtitle: "Calculate materials needed to upgrade your chief charms",
        charmSlot: "Charm Slot",
        fromLevel: "From Level",
        toLevel: "To Level",
        setAllFrom: "Set All From",
        setAllTo: "Set All To",
        setPieceFrom: "Set Piece From",
        setPieceTo: "Set Piece To",
        statBonus: "Stat Bonus",
        totalPower: "Total Power",
        powerGained: "Power Gained"
    },
    zh: {
        title: "ÁôΩÊó•Ê±ÇÁîüËÆ°ÁÆóÂô®",
        logoMain: "ÁôΩÊó•Ê±ÇÁîü",
        logoSub: "ËÆ°ÁÆóÂô®Â•ó‰ª∂",
        home: "È¶ñÈ°µ",
        heroTitle: "Ê∏∏ÊàèÂ¢ûÂº∫Â∑•ÂÖ∑",
        heroSubtitle: "ÈÄöËøáÁ≤æÁ°ÆËÆ°ÁÆó‰ºòÂåñÊÇ®ÁöÑÊ∏∏Êàè‰ΩìÈ™å",
        chiefGear: "È¶ñÈ¢ÜË£ÖÂ§á",
        chiefCharms: "È¶ñÈ¢ÜÁ¨¶Âíí",
        available: "ÂèØÁî®",
        comingSoon: "Âç≥Â∞ÜÊé®Âá∫",
        supportTitle: "ÊîØÊåÅÂºÄÂèë",
        supportDescription: "Â¶ÇÊûúÊÇ®ÊÉ≥Ë¥°ÁåÆÂπ∂ÊîØÊåÅÊàëÁöÑÂºÄÂèëÈ°πÁõÆ„ÄÇÊÇ®ÂèØ‰ª•‰ΩøÁî®‰∏ãÈù¢ÁöÑIDÁªôÊàëÈÄÅÁ§º„ÄÇ",
        gameId: "Ê∏∏ÊàèID",
        pageTitle: "È¶ñÈ¢ÜË£ÖÂ§áËÆ°ÁÆóÂô®",
        pageSubtitle: "ËÆ°ÁÆóÂçáÁ∫ßÈ¶ñÈ¢ÜË£ÖÂ§áÊâÄÈúÄÁöÑÊùêÊñô",
        currentInventory: "ÂΩìÂâçÂ∫ìÂ≠ò",
        quickSetAll: "Âø´ÈÄüËÆæÁΩÆÂÖ®ÈÉ®",
        currentLevel: "ÂΩìÂâçÁ≠âÁ∫ß",
        desiredLevel: "ÁõÆÊ†áÁ≠âÁ∫ß",
        selectLevel: "ÈÄâÊã©Á≠âÁ∫ß...",
        helmet: "Â§¥Áõî",
        chestplate: "ËÉ∏Áî≤",
        pants: "Êä§ËÖø",
        watch: "ÊâãË°®",
        ring: "ÊàíÊåá",
        staff: "Ê≥ïÊùñ",
        calculateMaterialsNeeded: "ËÆ°ÁÆóÊâÄÈúÄÊùêÊñô",
        upgradeAnalysis: "ÂçáÁ∫ßÂàÜÊûê",
        materialsNeededFor: "ÊâÄÈúÄÊùêÊñô‰∏∫",
        selectedPieces: "ÈÄâÂÆö‰ª∂Êï∞",
        sufficient: "‚úì ÂÖÖË∂≥",
        needMore: "ÈúÄË¶Å",
        more: "Êõ¥Â§ö",
        youHaveEnough: "ÊÇ®Êã•ÊúâË∂≥Â§üÔºÅ",
        additionalMaterialsNeeded: "ÊâÄÈúÄÈ¢ùÂ§ñÊùêÊñô",
        totalRequired: "ÊÄªÈúÄÊ±Ç",
        current: "ÂΩìÂâç",
        surplus: "Ââ©‰Ωô",
        missing: "Áº∫Â∞ë",
        desiredLevelRequired: "ÔºöÈúÄË¶ÅÁõÆÊ†áÁ≠âÁ∫ß",
        invalidDesiredLevel: "ÔºöÊó†ÊïàÁöÑÁõÆÊ†áÁ≠âÁ∫ß",
        desiredLevelMustBeHigher: "ÔºöÁõÆÊ†áÁ≠âÁ∫ßÂøÖÈ°ªÈ´ò‰∫éÂΩìÂâçÁ≠âÁ∫ß",
        selectAtLeastOnePiece: "ËØ∑Ëá≥Â∞ëÈÄâÊã©‰∏Ä‰ª∂Ë£ÖÂ§áÊù•ËÆ°ÁÆóÂçáÁ∫ßË¥πÁî®„ÄÇ",
        svsPointsGained: "Ëé∑ÂæóÁöÑSvSÁßØÂàÜ",
        totalSvsPoints: "ÊÄªSvSÁßØÂàÜ",
        charmsPageTitle: "È¶ñÈ¢ÜÁ¨¶ÂííËÆ°ÁÆóÂô®",
        charmsPageSubtitle: "ËÆ°ÁÆóÂçáÁ∫ßÈ¶ñÈ¢ÜÁ¨¶ÂííÊâÄÈúÄÁöÑÊùêÊñô",
        charmSlot: "Á¨¶ÂííÊßΩ",
        fromLevel: "‰ªéÁ≠âÁ∫ß",
        toLevel: "Âà∞Á≠âÁ∫ß",
        setAllFrom: "ËÆæÁΩÆÂÖ®ÈÉ®‰ªé",
        setAllTo: "ËÆæÁΩÆÂÖ®ÈÉ®Âà∞",
        setPieceFrom: "ËÆæÁΩÆË£ÖÂ§á‰ªé",
        setPieceTo: "ËÆæÁΩÆË£ÖÂ§áÂà∞",
        statBonus: "Â±ûÊÄßÂä†Êàê",
        totalPower: "ÊÄªÊàòÂäõ",
        powerGained: "Ëé∑ÂæóÊàòÂäõ"
    },
    ja: {
        title: "„Éõ„ÉØ„Ç§„Éà„Ç¢„Ç¶„Éà „Çµ„Éê„Ç§„Éê„É´ Ë®àÁÆóÊ©ü",
        logoMain: "„Éõ„ÉØ„Ç§„Éà„Ç¢„Ç¶„Éà „Çµ„Éê„Ç§„Éê„É´",
        logoSub: "Ë®àÁÆóÊ©ü„Çπ„Ç§„Éº„Éà",
        home: "„Éõ„Éº„É†",
        heroTitle: "„Ç≤„Éº„É†Âº∑Âåñ„ÉÑ„Éº„É´",
        heroSubtitle: "Á≤æÂØÜ„Å™Ë®àÁÆó„Åß„Ç≤„Éº„É†„Éó„É¨„Ç§„ÇíÊúÄÈÅ©Âåñ",
        chiefGear: "„ÉÅ„Éº„Éï„ÇÆ„Ç¢",
        chiefCharms: "„ÉÅ„Éº„Éï„ÉÅ„É£„Éº„É†",
        available: "Âà©Áî®ÂèØËÉΩ",
        comingSoon: "ËøëÊó•ÂÖ¨Èñã",
        supportTitle: "ÈñãÁô∫ÊîØÊè¥",
        supportDescription: "ÁßÅ„ÅÆÈñãÁô∫„Éó„É≠„Ç∏„Çß„ÇØ„Éà„Å´Ë≤¢ÁåÆ„ÅóÊîØÊè¥„Åó„Åü„ÅÑÂ†¥Âêà„ÅØ„ÄÅ‰∏ãË®ò„ÅÆID„Åß„ÇÆ„Éï„Éà„ÇíÈÄÅ„Çã„Åì„Å®„Åå„Åß„Åç„Åæ„Åô„ÄÇ",
        gameId: "„Ç≤„Éº„É† ID"
    },
    ko: {
        title: "ÌôîÏù¥Ìä∏ÏïÑÏõÉ ÏÑúÎ∞îÏù¥Î≤å Í≥ÑÏÇ∞Í∏∞",
        logoMain: "ÌôîÏù¥Ìä∏ÏïÑÏõÉ ÏÑúÎ∞îÏù¥Î≤å",
        logoSub: "Í≥ÑÏÇ∞Í∏∞ Î™®Ïùå",
        home: "Ìôà",
        heroTitle: "Í≤åÏûÑ Ìñ•ÏÉÅ ÎèÑÍµ¨",
        heroSubtitle: "Ï†ïÌôïÌïú Í≥ÑÏÇ∞ÏúºÎ°ú Í≤åÏûÑÌîåÎ†àÏù¥Î•º ÏµúÏ†ÅÌôî",
        chiefGear: "ÏπòÌîÑ Ïû•ÎπÑ",
        chiefCharms: "ÏπòÌîÑ Î∂ÄÏ†Å",
        available: "ÏÇ¨Ïö© Í∞ÄÎä•",
        comingSoon: "Í≥ß Ï∂úÏãú",
        supportTitle: "Í∞úÎ∞ú ÏßÄÏõê",
        supportDescription: "ÎÇ¥ Í∞úÎ∞ú ÌîÑÎ°úÏ†ùÌä∏Ïóê Í∏∞Ïó¨ÌïòÍ≥† ÏßÄÏõêÌïòÍ≥† Ïã∂Îã§Î©¥, ÏïÑÎûò IDÎ°ú ÏÑ†Î¨ºÏùÑ Î≥¥ÎÇº Ïàò ÏûàÏäµÎãàÎã§.",
        gameId: "Í≤åÏûÑ ID"
    },
    es: {
        title: "Calculadora Whiteout Survival",
        logoMain: "Whiteout Survival",
        logoSub: "Suite de Calculadoras",
        home: "Inicio",
        heroTitle: "Herramientas de Mejora del Juego",
        heroSubtitle: "Optimiza tu jugabilidad con c√°lculos precisos",
        chiefGear: "Equipo del Jefe",
        chiefCharms: "Encantos del Jefe",
        available: "Disponible",
        comingSoon: "Pr√≥ximamente",
        supportTitle: "Apoyar el Desarrollo",
        supportDescription: "Si quieres contribuir y apoyar mi proyecto de desarrollo. Puedes enviarme regalos usando mi ID de abajo.",
        gameId: "ID del Juego"
    },
    fr: {
        title: "Calculateur Whiteout Survival",
        logoMain: "Whiteout Survival",
        logoSub: "Suite de Calculateurs",
        home: "Accueil",
        heroTitle: "Outils d'Am√©lioration du Jeu",
        heroSubtitle: "Optimisez votre gameplay avec des calculs pr√©cis",
        chiefGear: "√âquipement du Chef",
        chiefCharms: "Charmes du Chef",
        available: "Disponible",
        comingSoon: "Bient√¥t Disponible",
        supportTitle: "Soutenir le D√©veloppement",
        supportDescription: "Si vous voulez contribuer et soutenir mon projet de d√©veloppement. Vous pouvez m'envoyer des cadeaux en utilisant mon ID ci-dessous.",
        gameId: "ID du Jeu"
    },
    de: {
        title: "Whiteout Survival Rechner",
        logoMain: "Whiteout Survival",
        logoSub: "Rechner-Suite",
        home: "Startseite",
        heroTitle: "Spiel-Verbesserungstools",
        heroSubtitle: "Optimieren Sie Ihr Gameplay mit pr√§zisen Berechnungen",
        chiefGear: "H√§uptlings-Ausr√ºstung",
        chiefCharms: "H√§uptlings-Amulette",
        available: "Verf√ºgbar",
        comingSoon: "Demn√§chst",
        supportTitle: "Entwicklung Unterst√ºtzen",
        supportDescription: "Wenn Sie zu meinem Entwicklungsprojekt beitragen und es unterst√ºtzen m√∂chten. Sie k√∂nnen mir Geschenke mit meiner unten stehenden ID senden.",
        gameId: "Spiel-ID"
    },
    ru: {
        title: "–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä Whiteout Survival",
        logoMain: "Whiteout Survival",
        logoSub: "–ù–∞–±–æ—Ä –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–æ–≤",
        home: "–ì–ª–∞–≤–Ω–∞—è",
        heroTitle: "–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –£–ª—É—á—à–µ–Ω–∏—è –ò–≥—Ä—ã",
        heroSubtitle: "–û–ø—Ç–∏–º–∏–∑–∏—Ä—É–π—Ç–µ —Å–≤–æ–π –≥–µ–π–º–ø–ª–µ–π —Å —Ç–æ—á–Ω—ã–º–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è–º–∏",
        chiefGear: "–°–Ω–∞—Ä—è–∂–µ–Ω–∏–µ –í–æ–∂–¥—è",
        chiefCharms: "–ê–º—É–ª–µ—Ç—ã –í–æ–∂–¥—è",
        available: "–î–æ—Å—Ç—É–ø–Ω–æ",
        comingSoon: "–°–∫–æ—Ä–æ",
        supportTitle: "–ü–æ–¥–¥–µ—Ä–∂–∞—Ç—å –†–∞–∑—Ä–∞–±–æ—Ç–∫—É",
        supportDescription: "–ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –≤–Ω–µ—Å—Ç–∏ –≤–∫–ª–∞–¥ –∏ –ø–æ–¥–¥–µ—Ä–∂–∞—Ç—å –º–æ–π –ø—Ä–æ–µ–∫—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏. –í—ã –º–æ–∂–µ—Ç–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –º–Ω–µ –ø–æ–¥–∞—Ä–∫–∏, –∏—Å–ø–æ–ª—å–∑—É—è –º–æ–π ID –Ω–∏–∂–µ.",
        gameId: "ID –ò–≥—Ä—ã"
    },
    pt: {
        title: "Calculadora Whiteout Survival",
        logoMain: "Whiteout Survival",
        logoSub: "Conjunto de Calculadoras",
        home: "In√≠cio",
        heroTitle: "Ferramentas de Melhoria do Jogo",
        heroSubtitle: "Otimize sua jogabilidade com c√°lculos precisos",
        chiefGear: "Equipamento do Chefe",
        chiefCharms: "Encantos do Chefe",
        available: "Dispon√≠vel",
        comingSoon: "Em Breve",
        supportTitle: "Apoiar o Desenvolvimento",
        supportDescription: "Se voc√™ quer contribuir e apoiar meu projeto de desenvolvimento. Voc√™ pode me enviar presentes usando meu ID abaixo.",
        gameId: "ID do Jogo"
    },
    it: {
        title: "Calcolatore Whiteout Survival",
        logoMain: "Whiteout Survival",
        logoSub: "Suite di Calcolatori",
        home: "Casa",
        heroTitle: "Strumenti di Miglioramento del Gioco",
        heroSubtitle: "Ottimizza il tuo gameplay con calcoli precisi",
        chiefGear: "Equipaggiamento del Capo",
        chiefCharms: "Incantesimi del Capo",
        available: "Disponibile",
        comingSoon: "Prossimamente",
        supportTitle: "Supporta lo Sviluppo",
        supportDescription: "Se vuoi contribuire e supportare il mio progetto di sviluppo. Puoi inviarmi regali usando il mio ID qui sotto.",
        gameId: "ID del Gioco"
    },
    ar: {
        title: "ÿ≠ÿßÿ≥ÿ®ÿ© ŸàÿßŸäÿ™ ÿ¢Ÿàÿ™ ÿ≥ÿ±ŸÅÿßŸäŸÅŸÑ",
        logoMain: "ŸàÿßŸäÿ™ ÿ¢Ÿàÿ™ ÿ≥ÿ±ŸÅÿßŸäŸÅŸÑ",
        logoSub: "ŸÖÿ¨ŸÖŸàÿπÿ© ÿßŸÑÿ≠ÿßÿ≥ÿ®ÿßÿ™",
        home: "ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©",
        heroTitle: "ÿ£ÿØŸàÿßÿ™ ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑŸÑÿπÿ®ÿ©",
        heroSubtitle: "ÿ≠ÿ≥ŸÜ ÿ∑ÿ±ŸäŸÇÿ© ŸÑÿπÿ®ŸÉ ÿ®ÿ≠ÿ≥ÿßÿ®ÿßÿ™ ÿØŸÇŸäŸÇÿ©",
        chiefGear: "ŸÖÿπÿØÿßÿ™ ÿßŸÑÿ≤ÿπŸäŸÖ",
        chiefCharms: "ÿ™ÿπÿßŸàŸäÿ∞ ÿßŸÑÿ≤ÿπŸäŸÖ",
        available: "ŸÖÿ™ÿßÿ≠",
        comingSoon: "ŸÇÿ±Ÿäÿ®ÿßŸã",
        supportTitle: "ÿØÿπŸÖ ÿßŸÑÿ™ÿ∑ŸàŸäÿ±",
        supportDescription: "ÿ•ÿ∞ÿß ŸÉŸÜÿ™ ÿ™ÿ±ŸäÿØ ÿßŸÑŸÖÿ≥ÿßŸáŸÖÿ© ŸàÿØÿπŸÖ ŸÖÿ¥ÿ±Ÿàÿπ ÿßŸÑÿ™ÿ∑ŸàŸäÿ± ÿßŸÑÿÆÿßÿµ ÿ®Ÿä. ŸäŸÖŸÉŸÜŸÉ ÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑŸáÿØÿßŸäÿß ÿ®ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ŸÖÿπÿ±ŸÅŸä ÿ£ÿØŸÜÿßŸá.",
        gameId: "ŸÖÿπÿ±ŸÅ ÿßŸÑŸÑÿπÿ®ÿ©"
    },
    hi: {
        title: "‡§µ‡•ç‡§π‡§æ‡§á‡§ü‡§Ü‡§â‡§ü ‡§∏‡§∞‡•ç‡§µ‡§æ‡§á‡§µ‡§≤ ‡§ï‡•à‡§≤‡§ï‡•Å‡§≤‡•á‡§ü‡§∞",
        logoMain: "‡§µ‡•ç‡§π‡§æ‡§á‡§ü‡§Ü‡§â‡§ü ‡§∏‡§∞‡•ç‡§µ‡§æ‡§á‡§µ‡§≤",
        logoSub: "‡§ï‡•à‡§≤‡§ï‡•Å‡§≤‡•á‡§ü‡§∞ ‡§∏‡•Ç‡§ü",
        home: "‡§Æ‡•Å‡§ñ‡§™‡•É‡§∑‡•ç‡§†",
        heroTitle: "‡§ó‡•á‡§Æ ‡§∏‡§Ç‡§µ‡§∞‡•ç‡§ß‡§® ‡§â‡§™‡§ï‡§∞‡§£",
        heroSubtitle: "‡§∏‡§ü‡•Ä‡§ï ‡§ó‡§£‡§®‡§æ‡§ì‡§Ç ‡§ï‡•á ‡§∏‡§æ‡§• ‡§Ö‡§™‡§®‡•á ‡§ó‡•á‡§Æ‡§™‡•ç‡§≤‡•á ‡§ï‡•ã ‡§Ö‡§®‡•Å‡§ï‡•Ç‡§≤‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç",
        chiefGear: "‡§ö‡•Ä‡§´ ‡§ó‡§ø‡§Ø‡§∞",
        chiefCharms: "‡§ö‡•Ä‡§´ ‡§ö‡§æ‡§∞‡•ç‡§Æ‡•ç‡§∏",
        available: "‡§â‡§™‡§≤‡§¨‡•ç‡§ß",
        comingSoon: "‡§ú‡§≤‡•ç‡§¶ ‡§Ü ‡§∞‡§π‡§æ ‡§π‡•à",
        supportTitle: "‡§µ‡§ø‡§ï‡§æ‡§∏ ‡§ï‡§æ ‡§∏‡§Æ‡§∞‡•ç‡§•‡§® ‡§ï‡§∞‡•á‡§Ç",
        supportDescription: "‡§Ø‡§¶‡§ø ‡§Ü‡§™ ‡§Æ‡•á‡§∞‡•á ‡§µ‡§ø‡§ï‡§æ‡§∏ ‡§™‡•ç‡§∞‡•ã‡§ú‡•á‡§ï‡•ç‡§ü ‡§Æ‡•á‡§Ç ‡§Ø‡•ã‡§ó‡§¶‡§æ‡§® ‡§î‡§∞ ‡§∏‡§Æ‡§∞‡•ç‡§•‡§® ‡§ï‡§∞‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç‡•§ ‡§Ü‡§™ ‡§®‡•Ä‡§ö‡•á ‡§¶‡§ø‡§è ‡§ó‡§è ‡§Æ‡•á‡§∞‡•á ID ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§â‡§™‡§π‡§æ‡§∞ ‡§≠‡•á‡§ú ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§",
        gameId: "‡§ó‡•á‡§Æ ‡§Ü‡§à‡§°‡•Ä"
    }
};

function loadIcon(container, itemData, onLoad = null) {
    if (!container) return;
    if (!itemData.icon || !itemData.icon.startsWith('http')) {
        container.textContent = itemData.fallback || '‚ùì';
        return;
    }

    const img = document.createElement('img');
    img.src = itemData.icon;
    img.alt = itemData.name;
    img.style.cssText = 'width:100%;height:100%;object-fit:contain;';
    
    img.onload = () => {
        container.innerHTML = '';
        container.appendChild(img);
        if (onLoad) onLoad(true);
    };
    
    img.onerror = () => {
        container.textContent = itemData.fallback || '‚ùì';
        if (onLoad) onLoad(false);
    };
}

function t(key, lang = 'en') {
    return TRANSLATIONS[lang]?.[key] || TRANSLATIONS.en[key] || key;
}

class ThemeManager {
    constructor() {
        this.currentTheme = localStorage.getItem('theme') || 'light-theme';
        this.applyTheme(this.currentTheme);
        this.setupEventListeners();
    }

    applyTheme(theme) {
        document.body.classList.remove('light-theme', 'dark-theme');
        document.body.classList.add(theme);
        this.currentTheme = theme;
    }

    toggleTheme() {
        const newTheme = this.currentTheme === 'light-theme' ? 'dark-theme' : 'light-theme';
        this.applyTheme(newTheme);
    }

    setupEventListeners() {
        const themeSwitcher = document.getElementById('theme-switcher');
        if (themeSwitcher) {
            themeSwitcher.addEventListener('click', () => this.toggleTheme());
        }
    }
}

class LanguageManager {
    constructor() {
        this.currentLanguage = localStorage.getItem('language') || 'en';
        this.setupEventListeners();
    }

    updateLanguage(lang) {
        this.currentLanguage = lang;
        localStorage.setItem('language', lang);
        
        document.title = t('title', lang);
        
        const languageBtn = document.getElementById('language-btn');
        if (languageBtn) languageBtn.textContent = lang.toUpperCase();
        
        document.querySelectorAll('.language-option').forEach(option => {
            option.classList.toggle('active', option.dataset.lang === lang);
        });

        document.dispatchEvent(new CustomEvent('languageChanged', { 
            detail: { language: lang, translations: TRANSLATIONS[lang] || TRANSLATIONS.en } 
        }));
    }

    setupEventListeners() {
        const languageBtn = document.getElementById('language-btn');
        const languageDropdown = document.getElementById('language-dropdown');

        if (languageBtn && languageDropdown) {
            languageBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                languageDropdown.classList.toggle('show');
            });

            languageDropdown.innerHTML = Object.entries(LANGUAGES).map(([code, lang]) => 
                `<div class="language-option ${code === this.currentLanguage ? 'active' : ''}" data-lang="${code}">
                    <span class="language-flag">${lang.flag}</span>
                    <span class="language-name">${lang.name}</span>
                </div>`
            ).join('');

            languageDropdown.addEventListener('click', (e) => {
                const option = e.target.closest('.language-option');
                if (option) {
                    this.updateLanguage(option.dataset.lang);
                    languageDropdown.classList.remove('show');
                }
            });

            document.addEventListener('click', (e) => {
                if (!e.target.closest('.language-selector')) {
                    languageDropdown.classList.remove('show');
                }
            });
        }
    }

    getCurrentTranslations() {
        return TRANSLATIONS[this.currentLanguage] || TRANSLATIONS.en;
    }
}

class Dropdown {
    constructor(element, options = {}) {
        this.element = element;
        this.toggle = element.querySelector('.dropdown-toggle');
        this.menu = element.querySelector('.dropdown-menu');
        this.options = options;
        this.selectedValue = '';
        this.selectedText = '';
        
        if (!this.toggle || !this.menu) return;
        this.setupEventListeners();
        this.populateOptions();
    }

    setupEventListeners() {
        this.toggle.addEventListener('click', (e) => {
            e.preventDefault();
            e.stopPropagation();
            this.toggleMenu();
        });
    }

    populateOptions() {
        if (!this.options.items) return;
        this.menu.innerHTML = this.options.items.map(item => 
            `<div class="dropdown-item" data-value="${item.value !== undefined ? item.value : item}">
                ${item.text || item}
            </div>`
        ).join('');

        this.menu.addEventListener('click', (e) => {
            const item = e.target.closest('.dropdown-item');
            if (item) {
                e.stopPropagation();
                this.selectItem(item.dataset.value, item.textContent);
            }
        });
    }

    selectItem(value, text) {
        this.selectedValue = value;
        this.selectedText = text;
        
        const toggleText = this.toggle.querySelector('.dropdown-text');
        if (toggleText) toggleText.textContent = text.trim();
        
        this.closeMenu();
        this.element.dispatchEvent(new CustomEvent('change', {
            detail: { value: this.selectedValue, text: this.selectedText }
        }));
    }

    toggleMenu() {
        const isOpening = !this.element.classList.contains('show');
        document.querySelectorAll('.dropdown.show').forEach(d => d.classList.remove('show'));
        document.querySelectorAll('.dropdown-menu.show').forEach(m => m.classList.remove('show'));
        
        if (isOpening) {
            this.element.classList.add('show');
            this.menu.classList.add('show');
        }
    }

    openMenu() {
        this.toggleMenu();
    }

    closeMenu() {
        this.element.classList.remove('show');
        this.menu.classList.remove('show');
    }

    setValue(value) {
        const item = this.options.items.find(item => 
            (item.value !== undefined ? item.value : item).toString() === value.toString()
        );
        if (item) this.selectItem(item.value !== undefined ? item.value : item, item.text || item);
    }

    getValue() { return this.selectedValue; }
    getText() { return this.selectedText; }
}

class ProtectionManager {
    constructor() {
        document.addEventListener('contextmenu', e => {
            if (!['INPUT', 'TEXTAREA'].includes(e.target.tagName)) e.preventDefault();
        });
        document.addEventListener('keydown', e => {
            if (e.keyCode === 123 || (e.ctrlKey && [85, 83].includes(e.keyCode))) e.preventDefault();
        });
    }
}

const addRippleEffect = (element, event) => {
    const rect = element.getBoundingClientRect();
    const ripple = document.createElement('div');
    const size = Math.max(rect.width, rect.height);
    ripple.style.cssText = `position:absolute;width:${size}px;height:${size}px;left:${event.clientX-rect.left-size/2}px;top:${event.clientY-rect.top-size/2}px;background:rgba(255,255,255,0.3);border-radius:50%;transform:scale(0);animation:ripple 0.6s linear;pointer-events:none;`;
    element.style.position = 'relative';
    element.style.overflow = 'hidden';
    element.appendChild(ripple);
    ripple.addEventListener('animationend', () => ripple.remove());
};

const formatNumber = num => num.toLocaleString();
const debounce = (func, wait) => {
    let timeout;
    return (...args) => {
        clearTimeout(timeout);
        timeout = setTimeout(() => func(...args), wait);
    };
};

function initializeCommon() {
    window.protectionManager = new ProtectionManager();
    window.themeManager = new ThemeManager();
    window.languageManager = new LanguageManager();

    document.querySelectorAll('.btn, .theme-btn, .language-btn').forEach(button => {
        button.addEventListener('click', e => addRippleEffect(button, e));
    });

    document.addEventListener('keydown', e => {
        if ((e.ctrlKey || e.metaKey) && e.key === 'd') {
            e.preventDefault();
            window.themeManager.toggleTheme();
        }
        if (e.key === 'Escape') {
            document.querySelectorAll('.dropdown.show, .language-dropdown.show').forEach(el => {
                el.classList.remove('show');
            });
        }
    });

    document.addEventListener('click', (e) => {
        if (!e.target.closest('.dropdown')) {
            document.querySelectorAll('.dropdown.show').forEach(d => {
                d.classList.remove('show');
                const menu = d.querySelector('.dropdown-menu');
                if(menu) menu.classList.remove('show');
            });
        }
    });

    const style = document.createElement('style');
    style.textContent = '@keyframes ripple{to{transform:scale(4);opacity:0;}}';
    document.head.appendChild(style);

    window.languageManager.updateLanguage(window.languageManager.currentLanguage);
}

if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initializeCommon);
} else {
    initializeCommon();
}
